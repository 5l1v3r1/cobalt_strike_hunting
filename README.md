# cobalt_strike_hunting
Hunting Cobalt Strike Beacons with Memory Forensics (attack &amp; defense)

#This work learning purpose only. 

The idea is use cobalt strike ps beacon for gaining shell access then hunt infected machine using memory forensics. When you are doing that you can gain more experience compromise analysis if you suspect any infected machine. 

**https://infosecarsenal.blogspot.com/2020/04/hunting-cobalt-strike-beacons-with.html**


***Tasks:***

**Install Fresh Kali Linux Distro**

**Install Windows2012R2 server or win8 client**

**Install Cobalt Strike Team Server**

**Run Cobalt Strike Team Server**

**Generate Cobalt Strike PS Beacon**

**Run Cobalt Strike beacon on Windows Machine**

**Control shell access with pid on cobalt strike team server**

**Run one click dumptit on windows machine for memory forensics**

**Upload raw memory image file to Kali Server**

**Install Cobalt Strike Plugins from JapanCert**

**Run Volatility Commands and observe outputs**


***References:***

https://www.mertsarica.com/onum-arkam-sagim-solum-cobalt-strike/

https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/

https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike

https://1337red.wordpress.com/getting-started-with-cobalt-strike/

https://www.ptsecurity.com/ww-en/analytics/advanced-persistent-threat-apt-attack-cost-report/

https://www.group-ib.com/blog/cobalt

https://www.pentestpartners.com/security-blog/cobalt-strike-walkthrough-for-red-teamers/

https://blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html

https://www.howtoforge.com/tutorial/how-to-install-and-use-volatility-memory-forensic-tool/

http://halilozturkci.com/adli-bilisim-dumpit-ile-windows-sistemlerde-hafiza-imaji-alma/

https://www.lac.co.jp/lacwatch/people/20180521_001638.html

https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html

https://github.com/JPCERTCC/aa-tools/blob/master/cobaltstrikescan.py

https://medium.com/@zemelusa/first-steps-to-volatile-memory-analysis-dcbd4d2d56a1

https://github.com/thimbleweed/All-In-USB/tree/master/utilities/DumpIt

https://github.com/volatilityfoundation/volatility/wiki/Command-Reference

https://resources.infosecinstitute.com/memory-forensics-and-analysis-using-volatility/#gref

https://ethicalhackingguru.com/how-to-use-cobalt-strike/

https://paste.ubuntu.com/p/y9hYfgQ2nS/

https://www.cobaltstrike.com/training

http://www.behindthefirewalls.com/2013/07/zeus-trojan-memory-forensics-with.html

https://unit42.paloaltonetworks.com/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/

https://attack.mitre.org/groups/G0080/

https://meltx0r.github.io/tech/2019/10/15/cobalt-gang-apt.html

https://github.com/Neo23x0/signature-base/blob/master/yara/apt_cobaltstrike.yar

https://infosecarsenal.blogspot.com/2020/04/hunting-cobalt-strike-beacons-with.html

https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html

https://imgflip.com/i/3xc98d

https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html

https://www.researchgate.net/figure/Lockheed-Martin-Cyber-Kill-Chain-CKC-22-seven-steps-The-part-that-is-specified-with_fig1_335024682
https://github.com/volatilityfoundation/volatility/wiki/Command-Reference-Mal#malfind

https://www.virustotal.com/gui/file/243238de25f261f6de5af5ba225cfe9a634240467688c8c3b3dd0279f04c326e/detection

https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/

https://github.com/AhmetHan/cobalt_strike_hunting
